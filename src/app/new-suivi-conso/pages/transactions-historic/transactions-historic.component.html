<div class="historic-transaction-page">
  <ng-container *ngIf="loadingTransactions else transactionsList">
    <div class="loader-container">
      <ion-skeleton-text animated class="header-loader"></ion-skeleton-text>
      <ion-skeleton-text animated class="conso-loader"></ion-skeleton-text>
      <ion-skeleton-text animated class="header-loader"></ion-skeleton-text>
      <ion-skeleton-text animated class="conso-loader"></ion-skeleton-text>
    </div>
  </ng-container>
  <ng-template #transactionsList>
    <!-- <div class="filtered-categories" *ngIf="categories?.length">
      <div class="category-item" *ngFor="let category of categories">
        <img [src]="getTransactionIcon(category.typeAchat)" alt="icon">
        <div class="cat-name">{{category?.label}}</div>
      </div>
    </div> -->



    <div class="filter-container">
      <div class="purchase-content-filter sargal-content-filter">
        <button class="filter-container" [ngClass]="{ selected: menuTrigType0.menuOpen }" mat-button
          #menuTrigType0="matMenuTrigger" [matMenuTriggerFor]="filterDates">
          <div [ngClass]="{ 'scb-text-white': menuTrigType0.menuOpen }" class="btn-filter">
            <span>{{ selectedDateFilter?.label}} </span>
            <div class="arrows">
              <img *ngIf="!menuTrigType0.menuOpen" src="/assets/images/arrow-down.svg" class="arrow-down" alt="">
              <img *ngIf="menuTrigType0.menuOpen" src="/assets/images/keyboard-arrow-up-black.svg" class="arrow-up"
                alt="">
            </div>
          </div>
        </button>
        <mat-menu [class]="'customize-mat-menu'" [backdropClass]="'cdk-overlay-pane-custom'" #filterDates="matMenu"
          class="leftSargal">
          <ng-template matMenuContent>
            <ng-container *ngFor="let filter of dateFilters ">
              <button (click)="filterByDate(filter)" class="categorie-label" mat-menu-item>
                {{ filter?.label }}
              </button>
            </ng-container>
          </ng-template>
        </mat-menu>
      </div>
      <div class="purchase-content-filter sargal-content-filter">
        <button class="filter-container" [ngClass]="{ selected: menuTrigType.menuOpen }" mat-button
          #menuTrigType="matMenuTrigger" [matMenuTriggerFor]="categoriesAchats">
          <div [ngClass]="{ 'scb-text-white': menuTrigType.menuOpen }" class="btn-filter">
            <span>{{ selectedFilter?.label}} </span>
            <div class="arrows">
              <img *ngIf="!menuTrigType.menuOpen" src="/assets/images/arrow-down.svg" class="arrow-down" alt="">
              <img *ngIf="menuTrigType.menuOpen" src="/assets/images/keyboard-arrow-up-black.svg" class="arrow-up"
                alt="">
            </div>
          </div>
        </button>
        <mat-menu [class]="'customize-mat-menu'" [backdropClass]="'cdk-overlay-pane-custom'" #categoriesAchats="matMenu"
          class="leftSargal">
          <ng-template matMenuContent>
            <ng-container *ngFor="let category of categories ">
              <button (click)="getTransactionByType(category)" class="categorie-label" mat-menu-item>
                {{ category?.label }}
              </button>
            </ng-container>
          </ng-template>
        </mat-menu>
      </div>
    </div>



    <div class="transaction-by-day" *ngFor="let transactionGroup of filteredHistoric">
      <div class="transaction-day-title">{{displayDate(transactionGroup?.key)}}</div>
      <div class="day-transactions-content">
        <div class="transaction-item" *ngFor="let transaction of transactionGroup?.value"
          (click)="openTransactionModal(transaction)">
          <img class="transaction-icon" [src]="getTransactionIcon(transaction.typeAchat)" alt="">
          <div class="left-bloc">
            <span class="transaction-type">{{transaction?.name}}</span>
            <span class="light-text scb-text-gray">{{transaction?.channel}}</span>
            <span class="light-text scb-text-gray">{{transaction?.msisdnReceiver | phoneNumberDisplay}}
              {{transaction?.msisdnReceiver === currentMsisdn ? ' (moi)' : ''}}</span>
          </div>
          <div class="right-bloc">
            <span class="transaction-price scb-text-orange">
              {{ transaction?.typeAchat === "TRANSFER" ? transaction?.amount - transaction?.fees : transaction?.amount
              }}
              {{ transaction.typeAchat === "SARGAL" ? 'Pts' : 'FCFA'}}
            </span>
            <span class="light-text scb-text-gray">{{transaction?.operationDate | date : 'dd/MM/yy Ã  HH:mm'}}</span>
            <span class="light-text scb-text-gray"></span>
          </div>
        </div>
      </div>
    </div>
  </ng-template>
</div>