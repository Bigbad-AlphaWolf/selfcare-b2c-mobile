<ion-header>
  <div class="arrow-left-container">
    <img src="/assets/images/arrow-left.svg" alt="" (click)="goToPreviousStep()" />
  </div>
</ion-header>

<ion-content>
  <div class="forgotpassword-page">
    <div class="content-block">
      <div class="forgotpassword-icon">
        <img src="/assets/images/group-167.svg" alt="" />
      </div>
      <div class="forgotpassword-title">
        <span class="forgotpassword-title-part-2">Je définis mon nouveau mot de passe</span>
      </div>

      <div class="forgotpassword-instruction">
        <span *ngIf="currentStep === 1"
          >Saisissez le téléphone lequel nous allons vous envoyer un code de vérification</span
        >
        <span *ngIf="currentStep === 2">Le mot de passe doit contenir au moins 5 caractères</span>
      </div>

      <div class="scb-form-block">
        <form
          autocomplete="false"
          *ngIf="currentStep === 1"
          [formGroup]="formIdentifier"
          (submit)="userSendIdentifier()"
        >
          <div class="input-text">
            <mat-form-field class="scb-input-row scb-required">
              <input matInput placeholder="Numéro de téléphone" formControlName="inputValue" type="tel" />
            </mat-form-field>
            <div class="form-error-message form-error-message-input-text">
              <span class="form-error-message-style">{{ error_message }}</span>
            </div>
            <div class="forgotpassword-btn-block">
              <button
                [disabled]="!formIdentifier.valid || loading"
                type="submit"
                class="scb-btn-full scb-btn-orange"
                mat-stroked-button
              >
                Suivant
                <mat-spinner mode="indeterminate" [diameter]="20" *ngIf="loading"></mat-spinner>
              </button>
            </div>
          </div>
        </form>
        <form autocomplete="false" *ngIf="currentStep === 2" [formGroup]="formPassword" (submit)="onSubmitPassword()">
          <div class="confirm-password">
            <mat-form-field class="scb-input-row scb-required">
              <input
                formControlName="otp"
                type="number"
                matInput
                placeholder="Entrez ici votre code de validation"
                autocomplete="off"
              />
            </mat-form-field>
            <mat-form-field class="scb-input-row scb-required">
              <input
                formControlName="password"
                [attr.type]="fields['password'].fieldType"
                matInput
                placeholder="Entrez ici votre mot de passe"
                autocomplete="off"
              /><mat-icon class="c-pointer" (click)="togglePasswordVisibility('password')" matSuffix>
                {{ fields['password'].visibilityIcon }}
              </mat-icon>
            </mat-form-field>
            <mat-form-field class="scb-input-row scb-required">
              <input
                formControlName="passwordConfirmation"
                [attr.type]="fields['confirmPassword'].fieldType"
                matInput
                placeholder="Entrez le mot de passe à nouveau"
                autocomplete="off"
              /><mat-icon class="c-pointer" (click)="togglePasswordVisibility('confirmPassword')" matSuffix>
                {{ fields['confirmPassword'].visibilityIcon }}
              </mat-icon>
            </mat-form-field>
            <div class="form-error-message form-error-message-input-password">
              <span class="form-error-message-style">{{ error_message }}</span>
            </div>

            <div class="forgotpassword-btn-block">
              <button
                [disabled]="!formPassword.valid || loading"
                type="submit"
                class="scb-btn-full scb-btn-orange"
                mat-stroked-button
              >
                Suivant
                <mat-spinner mode="indeterminate" [diameter]="20" *ngIf="loading"></mat-spinner>
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</ion-content>
